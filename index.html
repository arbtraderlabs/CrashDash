<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crash Dash - When the Market Breaks, You Don't.</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Papa Parse for CSV parsing - using local copy -->
    <script src="papaparse.min.js"></script>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="header-content">
            <div class="logo-section">
                <img src="assets/logo.svg" alt="Crash Dash Logo" class="logo">
            </div>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ğŸ” Search ticker or company name...">
            </div>
            <div class="header-last-update" style="display: flex; align-items: center; gap: 0.3rem; flex-shrink: 0;">
                <div style="display: flex; flex-direction: column; align-items: flex-end;">
                    <span id="headerLastUpdate" style="font-size: 0.7rem; font-weight: 600; color: var(--white); line-height: 1.2;">-</span>
                    <span id="headerLastUpdateTime" style="font-size: 0.55rem; color: rgba(255,255,255,0.8); line-height: 1;">-</span>
                    <span style="font-size: 0.55rem; font-style: italic; color: rgba(255,255,255,0.6); line-height: 1;">Last refresh</span>
                </div>
            </div>
            
            <!-- Hamburger Menu (Mobile Only) -->
            <button class="hamburger-menu" id="hamburgerMenu" onclick="toggleMobileNav()">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        
        <!-- Mobile Navigation Overlay -->
        <div class="mobile-nav-overlay" id="mobileNavOverlay" onclick="toggleMobileNav()">
            <div class="mobile-nav-content" onclick="event.stopPropagation()">
                <div class="mobile-nav-header">
                    <h3>Menu</h3>
                    <button class="mobile-nav-close" onclick="toggleMobileNav()">&times;</button>
                </div>
                <nav class="mobile-nav-links">
                    <a href="#" onclick="event.preventDefault(); closeOnboardingDrawer(); toggleMobileNav(); setTimeout(openOnboardingDrawer, 300);">ğŸš€ New Here? Start Here â†’</a>
                    <a href="about.html">ğŸ“– About</a>
                    <a href="strategy-guide.html">ğŸ“š Strategy</a>
                    <a href="faq.html">â“ FAQ</a>
                    <a href="roadmap.html">ğŸ§­ Roadmap</a>
                    <a href="https://x.com/CrashDashAI" target="_blank">
                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="display: inline-block; vertical-align: middle; margin-right: 0.5rem;">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                        Follow on X
                    </a>
                </nav>
            </div>
        </div>
        
        <!-- NAVIGATION AND FILTERS -->
        <div class="nav-and-filters">
            <nav class="nav-tabs">
                <a href="about.html">ğŸ“– About</a>
                <a href="strategy-guide.html">ğŸ“š Strategy</a>
                <a href="faq.html">â“ FAQ</a>
                <a href="roadmap.html">ğŸ§­ Roadmap</a>
                <a href="https://x.com/CrashDashAI" target="_blank" class="x-link" title="Follow us on X">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="display: inline-block; vertical-align: middle;">
                        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                    </svg>
                </a>
            </nav>
            <div class="header-filters">
                <button class="how-to-use-btn" onclick="openOnboardingDrawer()">ğŸš€ New Here? Start Here â†’</button>
                
                <button id="openFiltersBtn" class="filters-popup-button">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="1em" width="1em" style="fill: currentColor;">
                        <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
                    </svg>
                    <span>Filters</span>
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="0.9em" width="0.9em" style="fill: currentColor; opacity: 0.7; margin-left: 0.2rem;" onclick="event.stopPropagation(); resetFilters();" id="resetIconBtn" title="Reset Filters" style="display: none;">
                        <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                    </svg>
                </button>
                
                <!-- VIEW MODE TOGGLE -->
                <div class="view-mode-compact">
                    <label class="view-toggle-label-compact">View:</label>
                    <div class="toggle-switch-compact" onclick="toggleViewMode()">
                        <div class="toggle-track-compact">
                            <div id="toggleSlider" class="toggle-slider-compact"></div>
                        </div>
                        <span class="toggle-icon" id="compactIcon">â–¤</span>
                        <span class="toggle-icon" id="detailIcon">â˜°</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- HERO SECTION (Desktop Only) -->
    <div class="hero-section">
        <h1>CRASH DASH</h1>
        <p class="hero-tagline">Your source for mispriced fear and asymmetric opportunity.</p>
        <p class="hero-subtitle">When the Market Breaks, You Don't.</p>
    </div>

    <!-- MAIN CONTAINER -->
    <div class="container">
        
        <!-- STATS CARDS - COMPACT -->
        <div class="stats-grid-compact" id="statsGrid">
            <div class="stat-card-mini">
                <span class="stat-icon">ğŸ“Š</span>
                <div class="stat-content">
                    <span class="stat-value-mini" id="totalTickers">600+</span>
                    <span class="stat-label-mini">Tickers</span>
                </div>
            </div>
            <div class="stat-card-mini">
                <span class="stat-icon">ğŸ¯</span>
                <div class="stat-content">
                    <span class="stat-value-mini" id="totalSignals">-</span>
                    <span class="stat-label-mini">Buy Alerts</span>
                </div>
            </div>
            <div class="stat-card-mini highlight-purple">
                <span class="stat-icon">ğŸŸ£</span>
                <div class="stat-content">
                    <span class="stat-value-mini" id="purpleCount">-</span>
                    <span class="stat-label-mini">Enhanced</span>
                </div>
            </div>
            <div class="stat-card-mini highlight-red">
                <span class="stat-icon">ğŸ”´</span>
                <div class="stat-content">
                    <span class="stat-value-mini" id="redCount">-</span>
                    <span class="stat-label-mini">Ultra</span>
                </div>
            </div>
            <div class="stat-card-mini">
                <span class="stat-icon">â°</span>
                <div class="stat-content">
                    <span class="stat-value-mini" id="lastUpdate">-</span>
                </div>
            </div>
        </div>

        <!-- SMARTREPORT AI TEASER -->
        <div style="display: flex; justify-content: center; margin: 1.5rem 2rem;">
            <div class="ai-teaser-wrapper">
                <button class="ai-teaser-button" disabled>
                    <span class="ai-icon">âš¡</span>
                    <div class="ai-teaser-content">
                        <div class="ai-teaser-title">SmartReport AI</div>
                        <div class="ai-teaser-subtitle">COMING SOON</div>
                    </div>
                    <span class="ai-badge">Powered by Engine V4</span>
                </button>
            </div>
        </div>

        <!-- SIGNALS TABLE -->
        <div class="signals-table-wrapper" id="signalsWrapper" style="touch-action: pan-x; -ms-touch-action: pan-x; overscroll-behavior-x: contain;">
            <table class="signals-table">
                <thead>
                    <tr id="tableHeader">
                        <th class="sortable" data-sort="ticker">Ticker</th>
                        <th class="sortable" data-sort="date">Signal Date</th>
                        <th class="sortable" data-sort="signal_type">Signal Type</th>
                        <th class="sortable" data-sort="current_pnl">Returns</th>
                        <th class="sortable" data-sort="best_rally">Best Rally</th>
                        <th class="sortable" data-sort="ai_score"><span class="desktop-text">AI Score</span> âš¡</th>
                    </tr>
                    <tr id="compressedHeader" style="display: none;">
                        <th class="sortable" data-sort="ticker">Ticker</th>
                        <th class="sortable" data-sort="signal_count">Buy Alerts</th>
                        <th class="sortable" data-sort="latest_pnl">Returns</th>
                        <th class="sortable" data-sort="latest_score"><span class="desktop-text">AI Score</span> âš¡</th>
                    </tr>
                </thead>
                <tbody id="signalsTableBody">
                    <tr>
                        <td colspan="6" class="loading">Loading signals...</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

    <!-- FILTERS POPUP MODAL -->
    <div id="filtersModal" class="filters-modal" style="display: none;">
        <div class="filters-modal-overlay" onclick="closeFiltersModal()"></div>
        <div class="filters-modal-content">
            <div class="filters-modal-header">
                <h2>Filters</h2>
                <button class="filters-modal-close" onclick="closeFiltersModal()">&times;</button>
            </div>
            <div class="filters-modal-body">
                <div class="filter-group">
                    <label for="colorFilter">Signal Type</label>
                    <select id="colorFilter" onchange="updateFilterCount()">
                        <option value="">All Colors</option>
                        <option value="PURPLE">ğŸŸ£ Purple (Enhanced)</option>
                        <option value="RED">ğŸ”´ Red (Ultra)</option>
                        <option value="ORANGE">ğŸŸ  Orange (Extreme)</option>
                        <option value="GREEN">ğŸŸ¢ Green (Deep)</option>
                        <option value="YELLOW">ğŸŸ¡ Yellow (Crash)</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sectorFilter">Sector</label>
                    <select id="sectorFilter" onchange="updateFilterCount()">
                        <option value="">All Sectors</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="marketCapFilter">Market Cap</label>
                    <select id="marketCapFilter" onchange="updateFilterCount()">
                        <option value="">All Sizes</option>
                        <option value="0-1">< Â£1M (Nano)</option>
                        <option value="1-5">Â£1M - Â£5M</option>
                        <option value="5-20">Â£5M - Â£20M</option>
                        <option value="20-50">Â£20M - Â£50M</option>
                        <option value="50-100">Â£50M - Â£100M</option>
                        <option value="100-250">Â£100M - Â£250M</option>
                        <option value="250+">Â£250M+</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="dateRangeFilter">Signal Date</label>
                    <select id="dateRangeFilter" onchange="handleDateRangeChange(); updateFilterCount();">
                        <option value="all">All</option>
                        <option value="1m">1M</option>
                        <option value="3m" selected>3M</option>
                        <option value="6m">6M</option>
                        <option value="1y">1Y</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div id="customDateInputs" class="custom-date-inputs" style="display: none;">
                    <input type="date" id="startDate" placeholder="Start Date" onchange="updateFilterCount()">
                    <span>â†’</span>
                    <input type="date" id="endDate" placeholder="End Date" onchange="updateFilterCount()">
                </div>
            </div>
            <div class="filters-modal-footer">
                <button class="btn-secondary" onclick="resetFilters()">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" height="1em" width="1em" style="fill: currentColor; margin-right: 0.5rem;">
                        <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                    </svg>
                    Reset
                </button>
                <button class="btn-primary" onclick="applyFilters()">Apply</button>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
        <!-- FOOTER -->
    <footer style="margin-top: 4rem;">
        <p>&copy; 2025 CrashDash. Educational purposes only. Not financial advice.</p>
        <p style="margin-top: 0.5rem; font-size: 0.8rem;">âš¡ When the Market Breaks, You Learn.</p>
        <div style="margin-top: 1rem; display: flex; gap: 1.5rem; justify-content: center; align-items: center;">
            <a href="https://x.com/CrashDashAI" target="_blank" style="color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.85rem; display: flex; align-items: center; gap: 0.4rem;" title="Follow us on X">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                    <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
                Follow on X
            </a>
            <a href="https://forms.gle/C5GChwRu8wYshbS69" target="_blank" style="color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.85rem;">âœ‰ï¸ Contact Us</a>
        </div>
    </footer>

    <!-- ONBOARDING DRAWER -->
    <div class="onboarding-drawer" id="onboardingDrawer" role="dialog" aria-labelledby="onboarding-title" aria-hidden="true">
        <div class="onboarding-content">
            <button class="onboarding-close" onclick="closeOnboardingDrawer()" aria-label="Close onboarding">&times;</button>
            
            <h2 id="onboarding-title">ğŸ“š How to Use CrashDash</h2>

            <h3 class="guide-section-title">ğŸ¨ Signal Color Guide</h3>

            <div class="step step-purple">
                <strong>ğŸŸ£ PURPLE â€“ Enhanced Combo</strong><br>
                <em>What it means:</em> Our strongest type of setup. A major crash followed by signs of quiet buying and price stabilisation.<br><br>
                <em>How to use it:</em> Shortlist for your highest-conviction recovery ideas. Still high risk, but the most "stacked" conditions.
            </div>

            <div class="step step-red">
                <strong>ğŸ”´ RED â€“ Ultra Crash</strong><br>
                <em>What it means:</em> Brutal, wash-out style move. The stock has been hammered and is sitting in extreme crash territory.<br><br>
                <em>How to use it:</em> For traders who like maximum risk / maximum reward. Only makes sense if you truly understand the story and can handle heavy volatility.
            </div>

            <div class="step step-orange">
                <strong>ğŸŸ  ORANGE â€“ Extreme Crash</strong><br>
                <em>What it means:</em> Severe damage, but with signs that the selling pressure may be fading.<br><br>
                <em>How to use it:</em> Good for aggressive recovery hunters looking for big upside, while accepting that the trend may still be fragile.
            </div>

            <div class="step step-green">
                <strong>ğŸŸ¢ GREEN â€“ Deep Crash</strong><br>
                <em>What it means:</em> A deep sell-off with improving technical conditions and a more "controlled" crash profile.<br><br>
                <em>How to use it:</em> A balanced risk/reward zone. Often a sweet spot for people who want recovery potential without chasing the most extreme names.
            </div>

            <div class="step step-yellow">
                <strong>ğŸŸ¡ YELLOW â€“ Crash Zone</strong><br>
                <em>What it means:</em> The stock has entered a meaningful drawdown and is on our radar, but conditions are still developing.<br><br>
                <em>How to use it:</em> Treat these as early warning / watchlist candidates. Many will later get upgraded to Green, Orange, Red, or Purple if conditions strengthen.
            </div>

            <h3 class="guide-section-title">ğŸš€ Key Metrics (Simple & Powerful)</h3>

            <div class="step">
                <strong>âš¡ AI Technical Score:</strong> A blended strength score that highlights oversold zones, momentum exhaustion, and recovery potential. Higher = stronger reversal setup.
            </div>

            <div class="step">
                <strong>ğŸ“‰ Drawdown %:</strong> How far the stock has fallen from its peak to its lowest point.
            </div>

            <div class="step">
                <strong>ğŸ’° Current P&L:</strong> Your return (%) if you bought at the moment the crash signal appeared.
            </div>

            <div class="step">
                <strong>ğŸ“ˆ Best Rally:</strong> The strongest bounce seen after similar crash-type conditions in the past.
            </div>

            <div class="step">
                <strong>ğŸ”„ Cycle Position:</strong> Where the price sits inside its short-term range. 0% = bottom of the range, 100% = top of the range. Lower values often indicate pressure â†’ potential recovery zones.
            </div>

            <div class="step">
                <strong>ğŸŸ¢ Win Rate:</strong> How often similar setups historically turned positive.
            </div>

            <h3 class="guide-section-title">âš ï¸ Risk Flags (What to Watch Out For)</h3>

            <div class="step">
                <strong>ğŸ§© Near Corporate Action:</strong> Signal triggered around a stock split or similar event â€” price behaviour can be distorted.
            </div>

            <div class="step">
                <strong>ğŸª“ Reverse Split History:</strong> Company has consolidated shares. Often associated with long-term decline or dilution risks.
            </div>

            <div class="step">
                <strong>ğŸ©¹ Deep Drawdown (80%+):</strong> Ultra-high risk territory. Big rebounds possible â€” but equally big downside.
            </div>

            <div class="step">
                <strong>ğŸª™ Penny Stock Zone:</strong> Trading under 1p. Low liquidity, wild swings, unpredictable spreads.
            </div>

            <div class="step">
                <strong>ğŸ” Frequent Crashes:</strong> Multiple crash-type events detected â€” may indicate instability or broken trend structure.
            </div>

            <button class="primary-cta" onclick="closeOnboardingDrawer()">âœ… Got It! Let's Go</button>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script src="app.js"></script>
</body>
</html>
